{"ast":null,"code":"import _slicedToArray from \"/Users/arjunramesan/Documents/Projects/searchbar-widget/byjus-searchbar-widget/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport { MathJaxContext, MathJax } from 'better-react-mathjax';\nimport { encode } from 'url-encode-decode';\nimport Popup from 'reactjs-popup';\nvar styles = {\n  \"byjus_search_widget_searchBarHolder\": \"_styles-module__byjus_search_widget_searchBarHolder__2e8V-\",\n  \"byjus_search_widget_showinmobile\": \"_styles-module__byjus_search_widget_showinmobile__1sWi4\",\n  \"byjus_search_widget_showindesktop\": \"_styles-module__byjus_search_widget_showindesktop__lixBG\",\n  \"byjus_search_widget_searchBar\": \"_styles-module__byjus_search_widget_searchBar__1kt2A\",\n  \"byjus_search_widget_buttonContainer\": \"_styles-module__byjus_search_widget_buttonContainer__1stDp\",\n  \"byjus_search_widget_crossButtonHolder\": \"_styles-module__byjus_search_widget_crossButtonHolder__3x-TS\",\n  \"byjus_search_widget_buttonHolder\": \"_styles-module__byjus_search_widget_buttonHolder__AJfTZ\",\n  \"byjus_search_widget_icon\": \"_styles-module__byjus_search_widget_icon__BtSIS\",\n  \"byjus_search_widget_modal\": \"_styles-module__byjus_search_widget_modal__3TjXZ\",\n  \"byjus_search_widget_suggestionHolder\": \"_styles-module__byjus_search_widget_suggestionHolder__3MQD7\",\n  \"byjus_search_widget_searchbuttonHolder\": \"_styles-module__byjus_search_widget_searchbuttonHolder__3JPjB\",\n  \"byjus_search_widget_askADoubtPopupTopbannerCrossIcon\": \"_styles-module__byjus_search_widget_askADoubtPopupTopbannerCrossIcon__dnK_q\",\n  \"byjus_search_widget_cameraButtonHolder1\": \"_styles-module__byjus_search_widget_cameraButtonHolder1__2_3Lp\",\n  \"byjus_search_widget_cameraButtonHolder2\": \"_styles-module__byjus_search_widget_cameraButtonHolder2__qpuh-\",\n  \"byjus_search_widget_suggestionBox\": \"_styles-module__byjus_search_widget_suggestionBox__3r6G_\",\n  \"byjus_search_widget_historyBox\": \"_styles-module__byjus_search_widget_historyBox__1DDKh\",\n  \"hideImage\": \"_styles-module__hideImage__3aisW\",\n  \"byjus_search_widget_clockIcon\": \"_styles-module__byjus_search_widget_clockIcon__3xErD\",\n  \"byjus_search_widget_myQuestionHolder\": \"_styles-module__byjus_search_widget_myQuestionHolder__3g8iQ\",\n  \"byjus_search_widget_uploadButtonHolder\": \"_styles-module__byjus_search_widget_uploadButtonHolder__5PdOG\",\n  \"byjus_search_widget_thumbnailContainer\": \"_styles-module__byjus_search_widget_thumbnailContainer__118e1\",\n  \"byjus_search_widget_cameraImageCropperContainer\": \"_styles-module__byjus_search_widget_cameraImageCropperContainer__2hPAQ\",\n  \"byjus_search_widget_popupTitle\": \"_styles-module__byjus_search_widget_popupTitle__21lqL\"\n};\n\nvar SearchbarComponent = function SearchbarComponent(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      _setOpen = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      pageLoaded = _useState4[0],\n      _setPageLoaded = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      searchKeyword = _useState6[0],\n      setSearchKeyword = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      suggestions = _useState8[0],\n      setSuggestions = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      history = _useState10[0],\n      setHistory = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      inputFocus = _useState12[0],\n      setInputFocus = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      openMobileCam = _useState14[0],\n      setopenMobileCam = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      openDesktopPopup = _useState16[0],\n      setOpenDesktopPopup = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      imgUploaded = _useState18[0],\n      setimgUploaded = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      focusSearchbar = _useState20[0],\n      _setFocusSearchbar = _useState20[1];\n\n  var typeDelay = 500;\n  var MathjaxConfig = {\n    tex2jax: {\n      inlineMath: [[\"\\\\$\", \"\\\\$\"], [\"\\\\(\", \"\\\\)\"]],\n      displayMath: [[\"$$\", \"$$\"], [\"\\\\[\", \"\\\\]\"]],\n      processEscapes: true,\n      ignoreClass: \"tex2jax_ignore|dno\"\n    },\n    \"HTML-CSS\": {\n      styles: {\n        \".MathJax .mo, .MathJax .mi\": {\n          color: \"black ! important\"\n        },\n        '.MathJax .merror': {\n          'display': 'none'\n        }\n      },\n      linebreaks: {\n        automatic: true\n      }\n    },\n    SVG: {\n      linebreaks: {\n        automatic: true\n      }\n    }\n  };\n  var origin = 'learnportal2';\n  var API_ENDPOINT = 'https://search-api-stg.byjusweb.com/byjus/web_search/';\n  var AUTH_KEY = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJfaWQiOiI2MDVhMzc5MTg2M2YzYTViZTE0YjE0NzgiLCJyb2xlIjoiYnlqdS1hbnN3ZXItcmV2aWV3ZXIiLCJ0aW1lc3RhbXAiOiIyMDIxLTA1LTEwVDEwOjM0OjM4LjUyNloiLCJpYXQiOjE2MjA2NDI4Nzh9.f5xoVcgtvWAOwOnbc-VCMDjRwt7P4Pax5ftUL2TRUJQ';\n  var userToken = '2676038';\n  useEffect(function () {\n    console.log('Hello');\n  }, []);\n  useEffect(function () {\n    if (open == false && document.fullscreenElement != null) {\n      try {\n        document.exitFullscreen();\n      } catch (er) {}\n    }\n  }, [open]);\n  useEffect(function () {\n    var timeoutId = setTimeout(function () {\n      if (searchKeyword) {\n        get_suggestions(searchKeyword, userToken).then(function (r) {\n          return r.json();\n        }).then(function (res) {\n          var tempArray = [];\n\n          for (var i = 0; i < res['suggestions'].length; i++) {\n            tempArray.push({\n              'question_text': res['suggestions'][i]['mathjax_question'],\n              'question_id': res['suggestions'][i]['qid'],\n              'href': res['suggestions'][i]['href']\n            });\n          }\n\n          try {\n            setCookies('docId', res['docId'], {\n              maxAge: 60 * 60 * 24,\n              sameSite: \"none\",\n              secure: true\n            });\n          } catch (err) {}\n\n          setSuggestions(tempArray);\n        });\n      }\n    }, typeDelay);\n    return function () {\n      return clearTimeout(timeoutId);\n    };\n  }, [searchKeyword]);\n\n  function get_suggestions(text, userId) {\n    var formData = new FormData();\n    formData.append(\"text\", text);\n    formData.append(\"origin\", origin);\n    return fetch(API_ENDPOINT + 'get_suggestions/', {\n      method: 'POST',\n      headers: {\n        'Authorization': AUTH_KEY,\n        'X-Tnl-User-Id': userId\n      },\n      body: formData\n    });\n  }\n\n  function searchInput(value) {\n    setSearchKeyword(value);\n    setSuggestions([]);\n  }\n\n  function customSearch(text) {\n    clearSearch();\n\n    if (text) {\n      _setPageLoaded(false);\n\n      window.setTimeout(function () {\n        _setPageLoaded(true);\n      }, 3000);\n      text = text.replaceAll('+', '-plus-');\n      text = text.replaceAll('%', '-pcnt-');\n      text = text.replace(/(<([^>]+)>)/ig, '');\n      console.log('/search/' + encodeURI(encode(text)));\n    }\n  }\n\n  function enterButtonPressed(event) {\n    if (event.key === 'Enter') {\n      customSearch(searchKeyword);\n    }\n  }\n\n  function cameraClick() {\n    _setOpen(function (o) {\n      return !o;\n    });\n\n    setopenMobileCam(true);\n  }\n\n  function clearSearch() {\n    setInputFocus(false);\n    setSuggestions([]);\n    setSearchKeyword(null);\n    setHistory([]);\n    document.getElementById('searchInput').value = null;\n  }\n\n  function openHistory(ques) {\n    if (ques.href) {\n      console.log('/' + ques['href'] + '/');\n    } else {\n      console.log('/search/' + encodeURI(encode(ques['searchText'])) + '/');\n    }\n  }\n\n  function removeOptions(input) {\n    if (input) {\n      try {\n        var output = input.replace(/\\s*<ul[^>]*>[\\S\\s]*?<\\/ul>\\s*/, \"\");\n        output = output.replace(/\\s*<ol[^>]*>[\\S\\s]*?<\\/ol>\\s*/, \"\");\n        output = replaceS3(output);\n      } catch (err) {\n        return output;\n      }\n\n      return output;\n    }\n\n    return input;\n  }\n\n  function replaceS3(input) {\n    if (input) {\n      try {\n        var output = \"\";\n\n        if (isLive) {\n          output = input.replace(/https:\\/\\/meritnation-question-images.s3.ap-southeast-1.amazonaws.com/g, \"https://search-static.byjusweb.com/question-images\");\n        } else {\n          output = input.replace(/https:\\/\\/meritnation-question-images.s3.ap-southeast-1.amazonaws.com/g, \"https://search-static-stg.byjusweb.com/question-images\");\n        }\n\n        output = output.replace(/<div>&#xA0;<\\/div>/g, \"\");\n        output = output.replace(/<p>&#xA0;<\\/p>/g, \"\");\n        output = output.replace(/<span>&#xA0;<\\/span>/g, \"\");\n        output = output.replace(/<div>&#xA0;<\\/div>/g, \"\");\n        output = output.replace(/<br\\/><br\\/>/g, \"<br/>\");\n        output = output.replace(/<br><br><br>/g, \"<br>\");\n        output = output.replace(/<br><br>/g, \"<br>\");\n        output = output.replace(/&nbsp;/g, \" \");\n        output = output.replace(/&#xA0;/g, \" \");\n        output = output.replace(/<em>/g, \"\");\n        var re = new RegExp(String.fromCharCode(160), \"g\");\n        output = output.replace(re, \" \");\n      } catch (err) {\n        return input;\n      }\n\n      try {\n        var characters = output.split(\"\");\n        var urls = [];\n\n        for (var i = 0; i < characters.length; i++) {\n          if (characters[i] == \"s\" && characters[i + 1] == \"r\" && characters[i + 2] == \"c\" && characters[i + 3] == \"=\") {\n            var j = i + 5;\n            var found = false;\n            var url = \"\";\n\n            while (!found) {\n              if (characters[j] == '\"') {\n                found = true;\n                break;\n              }\n\n              url += characters[j];\n              j++;\n            }\n\n            urls.push(url);\n          }\n        }\n\n        for (var i = 0; i < urls.length; i++) {\n          var toReplace = urls[i].split(\"https://\")[1];\n          var goodString = toReplace.replace(\"//\", \"/\");\n          output = output.replace(toReplace, goodString);\n        }\n      } catch (err) {\n        return output;\n      }\n\n      return output;\n    }\n\n    return input;\n  }\n\n  function openQuestion(ques, i) {\n    console.log('/' + ques['href'] + '/');\n  }\n\n  function closeModal() {\n    _setOpen(false);\n  }\n\n  function showHistory(limit) {\n    getSearchHistory(limit).then(function (r) {\n      return r.json();\n    }).then(function (res) {\n      setHistory(res['questions_asked']);\n    });\n  }\n\n  function getSearchHistory(limit) {\n    return fetch(API_ENDPOINT + 'questions_by_user/' + userToken + '/' + limit + '/', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_searchBarHolder\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_searchBar\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_searchbuttonHolder\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_buttonHolder\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    onClick: function onClick() {\n      return customSearch(searchKeyword);\n    },\n    src: \"https://search-static-stg.byjusweb.com/assets/SearchIcon1.png\",\n    width: \"24\",\n    height: \"24\",\n    alt: \"SearchIcon\"\n  }))), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"searchInput\",\n    name: \"searchInput\",\n    type: \"text\",\n    placeholder: \"Search for questions & chapters\",\n    onFocus: function onFocus() {\n      setInputFocus(true);\n      showHistory(5);\n    },\n    onKeyPress: function onKeyPress(e) {\n      enterButtonPressed(e);\n    },\n    onKeyUp: function onKeyUp(e) {\n      return searchInput(e.target.value);\n    },\n    autoComplete: \"off\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_buttonContainer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_buttonHolder\n  }, (inputFocus || suggestions.length > 0 || history.length > 0) && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_crossButtonHolder\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.byjus_search_widget_icon,\n    onClick: function onClick() {\n      return clearSearch();\n    },\n    src: \"https://search-static-stg.byjusweb.com/assets/cancel.webp\",\n    width: \"12\",\n    height: \"12\",\n    alt: \"CrossIcon\"\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: inputFocus == true ? styles.byjus_search_widget_buttonHolder + ' ' + styles.showindesktop : styles.byjus_search_widget_buttonHolder\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_showinmobile\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_cameraButtonHolder1\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.byjus_search_widget_icon,\n    onClick: function onClick() {\n      return cameraClick();\n    },\n    src: \"https://search-static-stg.byjusweb.com/assets/Camera.png\",\n    width: \"24\",\n    height: \"24\",\n    alt: \"CameraIcon\"\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_showindesktop\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_cameraButtonHolder2\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.byjus_search_widget_icon,\n    onClick: function onClick() {\n      return imgSearch();\n    },\n    src: \"https://search-static-stg.byjusweb.com/assets/Camera.png\",\n    width: \"24\",\n    height: \"24\",\n    alt: \"CameraIcon\"\n  }))))), suggestions.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_suggestionHolder\n  }, suggestions.map(function (el, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: 'suggestion_' + i\n    }, el.href && /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.byjus_search_widget_suggestionBox,\n      onClick: function onClick() {\n        openQuestion(el);\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(MathJaxContext, {\n      config: MathjaxConfig\n    }, /*#__PURE__*/React.createElement(MathJax, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.hideImage,\n      dangerouslySetInnerHTML: {\n        __html: removeOptions(el.question_text) || ''\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"https://search-static-stg.byjusweb.com/assets/SearchRecommendation.png\",\n      width: \"24\",\n      height: \"24\",\n      alt: \"search-recommendation\"\n    }))));\n  })), suggestions.length == 0 && history.length > 0 && !searchKeyword && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.byjus_search_widget_suggestionHolder\n  }, history.map(function (el, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.byjus_search_widget_historyBox,\n      onClick: function onClick() {\n        openHistory(el);\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.byjus_search_widget_clockIcon\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"https://search-static-stg.byjusweb.com/assets/SearchHistory.png\",\n      width: \"20\",\n      height: \"20\",\n      alt: \"search-history\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(MathJaxContext, {\n      config: MathjaxConfig\n    }, /*#__PURE__*/React.createElement(MathJax, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.hideImage,\n      dangerouslySetInnerHTML: {\n        __html: removeOptions(el.searchText) || ''\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"https://search-static-stg.byjusweb.com/assets/SearchRecommendation.png\",\n      width: \"24\",\n      height: \"24\",\n      alt: \"search-recommendation\"\n    })));\n  }))), /*#__PURE__*/React.createElement(Popup, {\n    id: \"popup_camera\",\n    open: open,\n    modal: true,\n    closeOnDocumentClick: false,\n    onClose: closeModal,\n    className: \"uploadPopup\"\n  }, /*#__PURE__*/React.createElement(ImageSearchPopup, {\n    openMobileCam: openMobileCam,\n    setFocusSearchbar: function setFocusSearchbar(el) {\n      return _setFocusSearchbar(el);\n    },\n    setOpen: function setOpen(el) {\n      return _setOpen(el);\n    },\n    setPageLoaded: function setPageLoaded(el) {\n      return _setPageLoaded(el);\n    }\n  })), /*#__PURE__*/React.createElement(Popup, {\n    id: \"popup_camera_desktop\",\n    open: openDesktopPopup,\n    modal: true,\n    closeOnDocumentClick: false,\n    onClose: closeDesktopModal,\n    className: \"askADoubt-popup\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.askADoubtPopupTopbannerCrossIcon\n  }, /*#__PURE__*/React.createElement(Image, {\n    onClick: function onClick() {\n      setOpenDesktopPopup(false);\n    },\n    className: \"pointer\",\n    src: \"/question-answer/crossGreyIcon.png\",\n    alt: \"loader\",\n    height: \"40\",\n    width: \"40\"\n  })), /*#__PURE__*/React.createElement(ImageSearchDesktopPopup, {\n    setImageUploaded: function (_setImageUploaded) {\n      function setImageUploaded(_x) {\n        return _setImageUploaded.apply(this, arguments);\n      }\n\n      setImageUploaded.toString = function () {\n        return _setImageUploaded.toString();\n      };\n\n      return setImageUploaded;\n    }(function (el) {\n      return setImageUploaded(el);\n    }),\n    setPageLoaded: function setPageLoaded(el) {\n      return _setPageLoaded(el);\n    }\n  })));\n};\n\nexport { SearchbarComponent };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMaA,kBAAkB,GAAIC,SAAtBD,kBAAsBC,MAAD,EAAW;AAC3C,kBAAsBC,QAAQ,CAAC,KAAD,CAA9B;AAAA;AAAA,MAAKC,IAAL;AAAA,MAAWC,QAAX;;AACA,mBAAmCF,QAAQ,CAAC,IAAD,CAA3C;AAAA;AAAA,MAAMG,UAAN;AAAA,MAAkBC,cAAlB;;AACA,mBAAwCJ,QAAQ,CAAC,IAAD,CAAhD;AAAA;AAAA,MAAKK,aAAL;AAAA,MAAoBC,gBAApB;;AACA,mBAAoCN,QAAQ,CAAC,EAAD,CAA5C;AAAA;AAAA,MAAKO,WAAL;AAAA,MAAkBC,cAAlB;;AACA,mBAA4BR,QAAQ,CAAC,EAAD,CAApC;AAAA;AAAA,MAAKS,OAAL;AAAA,MAAcC,UAAd;;AACA,oBAAkCV,QAAQ,CAAC,KAAD,CAA1C;AAAA;AAAA,MAAKW,UAAL;AAAA,MAAiBC,aAAjB;;AACA,oBAAwCZ,QAAQ,CAAC,KAAD,CAAhD;AAAA;AAAA,MAAKa,aAAL;AAAA,MAAoBC,gBAApB;;AACA,oBAA8Cd,QAAQ,CAAC,KAAD,CAAtD;AAAA;AAAA,MAAKe,gBAAL;AAAA,MAAuBC,mBAAvB;;AACA,oBAAoChB,QAAQ,CAAC,KAAD,CAA5C;AAAA;AAAA,MAAKiB,WAAL;AAAA,MAAkBC,cAAlB;;AACA,oBAA0ClB,QAAQ,CAAC,KAAD,CAAlD;AAAA;AAAA,MAAKmB,cAAL;AAAA,MAAqBC,kBAArB;;AACA,MAAMC,SAAS,GAAG,GAAlB;AACA,MAAMC,aAAa,GAAG;AAACC,WAAO,EAAE;AAAEC,gBAAU,EAAE,CAAE,CAAC,KAAD,EAAQ,KAAR,CAAF,EAAkB,CAAC,KAAD,EAAQ,KAAR,CAAlB,CAAd;AAAkDC,iBAAW,EAAE,CAAE,CAAC,IAAD,EAAM,IAAN,CAAF,EAAe,CAAC,KAAD,EAAQ,KAAR,CAAf,CAA/D;AAAgGC,oBAAc,EAAE,IAAhH;AAAsHC,iBAAW,EAAE;AAAnI,KAAV;AAAoK,gBAAY;AAACC,YAAM,EAAE;AAAE,sCAA8B;AAACC,eAAK,EAAE;AAAR,SAAhC;AAA8D,4BAAoB;AAAC,qBAAW;AAAZ;AAAlF,OAAT;AAAiHC,gBAAU,EAAE;AAAEC,iBAAS,EAAC;AAAZ;AAA7H,KAAhL;AAAkUC,OAAG,EAAE;AAAEF,gBAAU,EAAE;AAAEC,iBAAS,EAAE;AAAb;AAAd;AAAvU,GAAtB;AAEA,MAAME,MAAM,GAAG,cAAf;AACA,MAAMC,YAAY,GAAG,uDAArB;AACA,MAAMC,QAAQ,GAAG,0PAAjB;AACA,MAAMC,SAAS,GAAG,SAAlB;AAEAC,WAAS,CAAC,YAAI;AACZC,WAAO,CAACC,GAARD,CAAY,OAAZA;AADO,KAEP,EAFO,CAATD;AAIAA,WAAS,CAAC,YAAI;AACZ,QAAGpC,IAAI,IAAE,KAANA,IAAeuC,QAAQ,CAACC,iBAATD,IAA4B,IAA9C,EAAmD;AAC/C,UAAG;AACCA,gBAAQ,CAACE,cAATF;AADJ,QAGA,OAAMG,EAAN,EAAS;AACZ;AANM,KAOJ,CAAC1C,IAAD,CAPI,CAAToC;AAUAA,WAAS,CAAC,YAAM;AACd,QAAMO,SAAS,GAAGC,UAAU,CAAC,YAAM;AAC/B,UAAGxC,aAAH,EAAiB;AACbyC,uBAAe,CAACzC,aAAD,EAAgB+B,SAAhB,CAAfU,CAA0CC,IAA1CD,CAA+CE,WAAC;AAAA,iBAAEA,CAAC,CAACC,IAAFD,EAAF;AAAA,SAAhDF,EAA4DC,IAA5DD,CAAiEI,aAAG,EAAE;AAClE,cAAIC,SAAS,GAAG,EAAhB;;AAEA,eAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,GAAG,CAAC,aAAD,CAAHA,CAAmBG,MAAjC,EAAwCD,CAAC,EAAzC,EAA4C;AACxCD,qBAAS,CAACG,IAAVH,CACI;AACI,+BAAkBD,GAAG,CAAC,aAAD,CAAHA,CAAmBE,CAAnBF,EAAsB,kBAAtBA,CADtB;AAEI,6BAAgBA,GAAG,CAAC,aAAD,CAAHA,CAAmBE,CAAnBF,EAAsB,KAAtBA,CAFpB;AAGI,sBAASA,GAAG,CAAC,aAAD,CAAHA,CAAmBE,CAAnBF,EAAsB,MAAtBA;AAHb,aADJC;AAOH;;AACD,cAAG;AACCI,sBAAU,CAAC,OAAD,EAAUL,GAAG,CAAC,OAAD,CAAb,EAAwB;AAACM,oBAAM,EAAE,KAAK,EAAL,GAAU,EAAnB;AAAuBC,sBAAQ,EAAE,MAAjC;AAAyCC,oBAAM,EAAE;AAAjD,aAAxB,CAAVH;AADJ,YAGA,OAAMI,GAAN,EAAU;;AACVnD,wBAAc,CAAC2C,SAAD,CAAd3C;AAhBJ;AAkBH;AApBuB,OAqBrBa,SArBqB,CAA5B;AAuBA,WAAO;AAAA,aAAMuC,YAAY,CAAChB,SAAD,CAAlB;AAAA,KAAP;AAxBO,KAyBJ,CAACvC,aAAD,CAzBI,CAATgC;;AA2BE,WAASS,eAAT,CAAyBe,IAAzB,EAA+BC,MAA/B,EAAuC;AACnC,QAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,YAAQ,CAACE,MAATF,CAAgB,MAAhBA,EAAwBF,IAAxBE;AACAA,YAAQ,CAACE,MAATF,CAAgB,QAAhBA,EAA0B9B,MAA1B8B;AACA,WAAOG,KAAK,CAAChC,YAAY,GAAG,kBAAhB,EAAoC;AAC5CiC,YAAM,EAAE,MADoC;AAE5CC,aAAO,EAAE;AACL,yBAAkBjC,QADb;AAEL,yBAAkB2B;AAFb,OAFmC;AAM5CO,UAAI,EAAEN;AANsC,KAApC,CAAZ;AASH;;AAED,WAASO,WAAT,CAAqBC,KAArB,EAA2B;AACvBjE,oBAAgB,CAACiE,KAAD,CAAhBjE;AACAE,kBAAc,CAAC,EAAD,CAAdA;AACH;;AAED,WAASgE,YAAT,CAAsBX,IAAtB,EAA2B;AACvBY,eAAW;;AACX,QAAGZ,IAAH,EAAQ;AACJzD,oBAAa,CAAC,KAAD,CAAbA;;AACAsE,YAAM,CAAC7B,UAAP6B,CAAkB,YAAI;AAACtE,sBAAa,CAAC,IAAD,CAAbA;AAAvB,SAA4C,IAA5CsE;AACAb,UAAI,GAAGA,IAAI,CAACc,UAALd,CAAgB,GAAhBA,EAAqB,QAArBA,CAAPA;AACAA,UAAI,GAAGA,IAAI,CAACc,UAALd,CAAgB,GAAhBA,EAAqB,QAArBA,CAAPA;AACAA,UAAI,GAAGA,IAAI,CAACe,OAALf,CAAc,eAAdA,EAA+B,EAA/BA,CAAPA;AACAvB,aAAO,CAACC,GAARD,CAAa,aAAauC,SAAS,CAACC,MAAM,CAACjB,IAAD,CAAP,CAAnCvB;AACH;AACJ;;AAED,WAASyC,kBAAT,CAA4BC,KAA5B,EAAkC;AAC9B,QAAGA,KAAK,CAACC,GAAND,KAAc,OAAjB,EAAyB;AACrBR,kBAAY,CAACnE,aAAD,CAAZmE;AACD;AACN;;AAMD,WAASU,WAAT,GAAsB;AAClBhF,YAAO,CAACiF,WAAC;AAAA,aAAI,CAACA,CAAL;AAAA,KAAF,CAAPjF;;AACAY,oBAAgB,CAAC,IAAD,CAAhBA;AAEH;;AAED,WAAS2D,WAAT,GAAsB;AAClB7D,iBAAa,CAAC,KAAD,CAAbA;AACAJ,kBAAc,CAAC,EAAD,CAAdA;AACAF,oBAAgB,CAAC,IAAD,CAAhBA;AACAI,cAAU,CAAC,EAAD,CAAVA;AACA8B,YAAQ,CAAC4C,cAAT5C,CAAwB,aAAxBA,EAAuC+B,KAAvC/B,GAA+C,IAA/CA;AACH;;AAED,WAAS6C,WAAT,CAAqBC,IAArB,EAA0B;AACtB,QAAGA,IAAI,CAACC,IAAR,EAAa;AACTjD,aAAO,CAACC,GAARD,CAAY,MAAMgD,IAAI,CAAC,MAAD,CAAV,GAAqB,GAAjChD;AADJ,WAGI;AACAA,aAAO,CAACC,GAARD,CAAY,aAAauC,SAAS,CAACC,MAAM,CAACQ,IAAI,CAAC,YAAD,CAAL,CAAP,CAAtB,GAAqD,GAAjEhD;AACH;AACJ;;AAED,WAASkD,aAAT,CAAuBC,KAAvB,EAA8B;AAC1B,QAAIA,KAAJ,EAAW;AACT,UAAI;AACF,YAAIC,MAAM,GAAGD,KAAK,CAACb,OAANa,CAAc,+BAAdA,EAA+C,EAA/CA,CAAb;AACAC,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,+BAAfA,EAAgD,EAAhDA,CAATA;AACAA,cAAM,GAAGC,SAAS,CAACD,MAAD,CAAlBA;AAHF,QAIE,OAAO/B,GAAP,EAAY;AACZ,eAAO+B,MAAP;AACD;;AACD,aAAOA,MAAP;AACD;;AAED,WAAOD,KAAP;AACD;;AAEH,WAASE,SAAT,CAAmBF,KAAnB,EAA0B;AACtB,QAAIA,KAAJ,EAAW;AACT,UAAI;AACF,YAAIC,MAAM,GAAG,EAAb;;AACA,YAAIE,MAAJ,EAAY;AACVF,gBAAM,GAAGD,KAAK,CAACb,OAANa,CACP,wEADOA,EAEP,oDAFOA,CAATC;AADF,eAKO;AACLA,gBAAM,GAAGD,KAAK,CAACb,OAANa,CACP,wEADOA,EAEP,wDAFOA,CAATC;AAID;;AACDA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,qBAAfA,EAAsC,EAAtCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,iBAAfA,EAAkC,EAAlCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,uBAAfA,EAAwC,EAAxCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,qBAAfA,EAAsC,EAAtCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,eAAfA,EAAgC,OAAhCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,eAAfA,EAAgC,MAAhCA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,WAAfA,EAA4B,MAA5BA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,SAAfA,EAA0B,GAA1BA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,SAAfA,EAA0B,GAA1BA,CAATA;AACAA,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAe,OAAfA,EAAwB,EAAxBA,CAATA;AACA,YAAIG,EAAE,GAAG,IAAIC,MAAJ,CAAWC,MAAM,CAACC,YAAPD,CAAoB,GAApBA,CAAX,EAAqC,GAArC,CAAT;AACAL,cAAM,GAAGA,MAAM,CAACd,OAAPc,CAAeG,EAAfH,EAAmB,GAAnBA,CAATA;AAxBF,QAyBE,OAAO/B,GAAP,EAAY;AACZ,eAAO8B,KAAP;AACD;;AAED,UAAI;AACF,YAAIQ,UAAU,GAAGP,MAAM,CAACQ,KAAPR,CAAa,EAAbA,CAAjB;AACA,YAAIS,IAAI,GAAG,EAAX;;AAEA,aAAK,IAAI/C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6C,UAAU,CAAC5C,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,cACE6C,UAAU,CAAC7C,CAAD,CAAV6C,IAAiB,GAAjBA,IACAA,UAAU,CAAC7C,CAAC,GAAG,CAAL,CAAV6C,IAAqB,GADrBA,IAEAA,UAAU,CAAC7C,CAAC,GAAG,CAAL,CAAV6C,IAAqB,GAFrBA,IAGAA,UAAU,CAAC7C,CAAC,GAAG,CAAL,CAAV6C,IAAqB,GAJvB,EAKE;AACA,gBAAIG,CAAC,GAAGhD,CAAC,GAAG,CAAZ;AACA,gBAAIiD,KAAK,GAAG,KAAZ;AACA,gBAAIC,GAAG,GAAG,EAAV;;AACA,mBAAO,CAACD,KAAR,EAAe;AACb,kBAAIJ,UAAU,CAACG,CAAD,CAAVH,IAAiB,GAArB,EAA0B;AACxBI,qBAAK,GAAG,IAARA;AACA;AACD;;AACDC,iBAAG,IAAIL,UAAU,CAACG,CAAD,CAAjBE;AACAF,eAAC;AACF;;AACDD,gBAAI,CAAC7C,IAAL6C,CAAUG,GAAVH;AACD;AACF;;AACD,aAAK,IAAI/C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+C,IAAI,CAAC9C,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AACpC,cAAImD,SAAS,GAAGJ,IAAI,CAAC/C,CAAD,CAAJ+C,CAAQD,KAARC,CAAc,UAAdA,EAA0B,CAA1BA,CAAhB;AACA,cAAIK,UAAU,GAAGD,SAAS,CAAC3B,OAAV2B,CAAkB,IAAlBA,EAAwB,GAAxBA,CAAjB;AACAb,gBAAM,GAAGA,MAAM,CAACd,OAAPc,CAAea,SAAfb,EAA0Bc,UAA1Bd,CAATA;AACD;AA7BH,QA8BE,OAAO/B,GAAP,EAAY;AACZ,eAAO+B,MAAP;AACD;;AAED,aAAOA,MAAP;AACD;;AAED,WAAOD,KAAP;AACD;;AAEH,WAASgB,YAAT,CAAsBnB,IAAtB,EAA4BlC,CAA5B,EAA8B;AAC1Bd,WAAO,CAACC,GAARD,CAAY,MAAMgD,IAAI,CAAC,MAAD,CAAV,GAAqB,GAAjChD;AACH;;AAED,WAASoE,UAAT,GAAqB;AACjBxG,YAAO,CAAC,KAAD,CAAPA;AACH;;AAGD,WAASyG,WAAT,CAAqBC,KAArB,EAA2B;AACvBC,oBAAgB,CAACD,KAAD,CAAhBC,CAAwB9D,IAAxB8D,CAA6B7D,WAAC;AAAA,aAAEA,CAAC,CAACC,IAAFD,EAAF;AAAA,KAA9B6D,EAA0C9D,IAA1C8D,CAA+C3D,aAAG,EAAE;AAChDxC,gBAAU,CAACwC,GAAG,CAAC,iBAAD,CAAJ,CAAVxC;AADJ;AAGH;;AAED,WAASmG,gBAAT,CAA0BD,KAA1B,EAAgC;AAC1B,WAAO1C,KAAK,CAAChC,YAAY,GAAG,oBAAfA,GAAsCE,SAAtCF,GAAkD,GAAlDA,GAAwD0E,KAAxD1E,GAAgE,GAAjE,EAAsE;AAC9EiC,YAAM,EAAE,KADsE;AAE9EC,aAAO,EAAE;AACL,wBAAgB;AADX;AAFqE,KAAtE,CAAZ;AAML;;AAcD,sBACM0C;AAAKC,aAAS,EAAEnF,MAAM,CAACoF;AAAvB,kBACEF;AAAKC,aAAS,EAAEnF,MAAM,CAACqF;AAAvB,kBACIH;AAAKC,aAAS,EAAEnF,MAAM,CAACsF;AAAvB,kBACIJ;AAAKC,aAAS,EAAEnF,MAAM,CAACuF;AAAvB,kBACIL;AAAMM,WAAO,EAAE;AAAA,aAAM5C,YAAY,CAACnE,aAAD,CAAlB;AAAA,KAAf;AAAkDgH,OAAG,EAAE,+DAAvD;AAAwHC,SAAK,EAAC,IAA9H;AAAmIC,UAAM,EAAC,IAA1I;AAA+IC,OAAG,EAAC;AAAnJ,IADJ,CADJ,CADJ,eAMIV,8CACIA;AAAOW,MAAE,EAAC,aAAV;AAAwBC,QAAI,EAAC,aAA7B;AAA2CC,QAAI,EAAC,MAAhD;AAAuDC,eAAW,mCAAlE;AAAwGC,WAAO,EAAE,mBAAM;AAACjH,mBAAa,CAAC,IAAD,CAAbA;AAAoB+F,iBAAW,CAAC,CAAD,CAAXA;AAA5I;AAA8JmB,cAAU,EAAGC,qBAAD,EAAO;AAAChD,wBAAkB,CAACgD,CAAD,CAAlBhD;AAAlL;AAA0MiD,WAAO,EAAGD,kBAAD;AAAA,aAAKzD,WAAW,CAACyD,CAAC,CAACE,MAAFF,CAASxD,KAAV,CAAhB;AAAA,KAAnN;AAAqP2D,gBAAY,EAAC;AAAlQ,IADJ,CANJ,eASIpB;AAAKC,aAAS,EAAEnF,MAAM,CAACuG;AAAvB,kBACIrB;AAAKC,aAAS,EAAEnF,MAAM,CAACuF;AAAvB,KACM,CAACxG,UAAU,IAAIJ,WAAW,CAAC8C,MAAZ9C,GAAmB,CAAjCI,IAAsCF,OAAO,CAAC4C,MAAR5C,GAAe,CAAtD,kBAA4DqG;AAAKC,aAAS,EAAEnF,MAAM,CAACwG;AAAvB,kBAC1DtB;AAAKC,aAAS,EAAEnF,MAAM,CAACyG,wBAAvB;AAAiDjB,WAAO,EAAE;AAAA,aAAM3C,WAAW,EAAjB;AAAA,KAA1D;AAA+E4C,OAAG,EAAE,2DAApF;AAAiJC,SAAK,EAAC,IAAvJ;AAA4JC,UAAM,EAAC,IAAnK;AAAwKC,OAAG,EAAC;AAA5K,IAD0D,CADlE,CADJ,eAQIV;AAAKC,aAAS,EAAGpG,UAAU,IAAI,IAAdA,GAAsBiB,MAAM,CAACuF,gCAAPvF,GAA0C,GAA1CA,GAAgDA,MAAM,CAAC0G,aAA7E3H,GAA+FiB,MAAM,CAACuF;AAAvH,kBACIL;AAAKC,aAAS,EAAEnF,MAAM,CAAC2G;AAAvB,kBACIzB;AAAKC,aAAS,EAAEnF,MAAM,CAAC4G;AAAvB,kBACI1B;AAAKC,aAAS,EAAEnF,MAAM,CAACyG,wBAAvB;AAAiDjB,WAAO,EAAE;AAAA,aAAMlC,WAAW,EAAjB;AAAA,KAA1D;AAA+EmC,OAAG,EAAE,0DAApF;AAAgJC,SAAK,EAAC,IAAtJ;AAA2JC,UAAM,EAAC,IAAlK;AAAuKC,OAAG,EAAC;AAA3K,IADJ,CADJ,CADJ,eAMIV;AAAKC,aAAS,EAAEnF,MAAM,CAAC6G;AAAvB,kBACI3B;AAAKC,aAAS,EAAEnF,MAAM,CAAC8G;AAAvB,kBACI5B;AAAKC,aAAS,EAAEnF,MAAM,CAACyG,wBAAvB;AAAiDjB,WAAO,EAAE;AAAA,aAAMuB,SAAS,EAAf;AAAA,KAA1D;AAA6EtB,OAAG,EAAE,0DAAlF;AAA8IC,SAAK,EAAC,IAApJ;AAAyJC,UAAM,EAAC,IAAhK;AAAqKC,OAAG,EAAC;AAAzK,IADJ,CADJ,CANJ,CARJ,CATJ,EA+BKjH,WAAW,CAAC8C,MAAZ9C,GAAmB,CAAnBA,iBACGuG;AAAKC,aAAS,EAAEnF,MAAM,CAACgH;AAAvB,KACKrI,WAAW,CAACsI,GAAZtI,CAAgB,UAACuI,EAAD,EAAI1F,CAAJ;AAAA,wBACjB0D;AAAK7B,SAAG,EAAE,gBAAgB7B;AAA1B,OACC0F,EAAE,CAACvD,IAAHuD,iBACDhC;AAAKC,eAAS,EAAEnF,MAAM,CAACmH,iCAAvB;AAA0D3B,aAAO,EAAE,mBAAM;AAACX,oBAAY,CAACqC,EAAD,CAAZrC;AAAqB;AAA/F,oBACIK,8CACAA,oBAACkC,cAAD;AAAgBC,YAAM,EAAE3H;AAAxB,oBACIwF,oBAACoC,OAAD,qBACIpC;AAAKC,eAAS,EAAEnF,MAAM,CAACuH,SAAvB;AAAkCC,6BAAuB,EAAE;AAAEC,cAAM,EAAE7D,aAAa,CAACsD,EAAE,CAACQ,aAAJ,CAAb9D,IAAmC;AAA7C;AAA3D,MADJ,CADJ,CADA,CADJ,eAQIsB,8CACIA;AAAKO,SAAG,EAAE,wEAAV;AAAoFC,WAAK,EAAC,IAA1F;AAA+FC,YAAM,EAAC,IAAtG;AAA2GC,SAAG,EAAC;AAA/G,MADJ,CARJ,CAFA,CADiB;AAAA,GAAhBjH,CADL,CAhCR,EAqDKA,WAAW,CAAC8C,MAAZ9C,IAAsB,CAAtBA,IAA2BE,OAAO,CAAC4C,MAAR5C,GAAiB,CAA5CF,IAAiD,CAACF,aAAlDE,iBACGuG;AAAKC,aAAS,EAAEnF,MAAM,CAACgH;AAAvB,KACKnI,OAAO,CAACoI,GAARpI,CAAY,UAACqI,EAAD,EAAI1F,CAAJ;AAAA,wBACb0D;AAAKC,eAAS,EAAEnF,MAAM,CAAC2H,8BAAvB;AAAuDnC,aAAO,EAAE,mBAAM;AAAC/B,mBAAW,CAACyD,EAAD,CAAXzD;AAAiB;AAAxF,oBACIyB;AAAKC,eAAS,EAAEnF,MAAM,CAAC4H;AAAvB,oBACI1C;AAAKO,SAAG,EAAE,iEAAV;AAA6EC,WAAK,EAAC,IAAnF;AAAwFC,YAAM,EAAC,IAA/F;AAAoGC,SAAG,EAAC;AAAxG,MADJ,CADJ,eAIIV,8CACIA,oBAACkC,cAAD;AAAgBC,YAAM,EAAE3H;AAAxB,oBACIwF,oBAACoC,OAAD,qBACIpC;AAAKC,eAAS,EAAEnF,MAAM,CAACuH,SAAvB;AAAkCC,6BAAuB,EAAE;AAAEC,cAAM,EAAE7D,aAAa,CAACsD,EAAE,CAACW,UAAJ,CAAbjE,IAAgC;AAA1C;AAA3D,MADJ,CADJ,CADJ,CAJJ,eAWIsB,8CACIA;AAAKO,SAAG,EAAE,wEAAV;AAAoFC,WAAK,EAAC,IAA1F;AAA+FC,YAAM,EAAC,IAAtG;AAA2GC,SAAG,EAAC;AAA/G,MADJ,CAXJ,CADa;AAAA,GAAZ/G,CADL,CAtDR,CADF,eA6EEqG,oBAAC4C,KAAD;AAAOjC,MAAE,EAAC,cAAV;AAAyBxH,QAAI,EAAEA,IAA/B;AAAqC0J,SAAK,MAA1C;AAA2CC,wBAAoB,EAAE,KAAjE;AAAwEC,WAAO,EAAEnD,UAAjF;AAA6FK,aAAS,EAAC;AAAvG,kBACID,oBAACgD,gBAAD;AAAkBjJ,iBAAa,EAAIA,aAAnC;AAAkDO,qBAAiB,EAAI0H,6BAAE;AAAA,aAAI1H,kBAAiB,CAAC0H,EAAD,CAArB;AAAA,KAAzE;AAAoG5I,WAAO,EAAE4I,mBAAE;AAAA,aAAI5I,QAAO,CAAC4I,EAAD,CAAX;AAAA,KAA/G;AAAgI1I,iBAAa,EAAE0I,yBAAE;AAAA,aAAI1I,cAAa,CAAC0I,EAAD,CAAjB;AAAA;AAAjJ,IADJ,CA7EF,eAgFEhC,oBAAC4C,KAAD;AAAQjC,MAAE,EAAC,sBAAX;AAAkCxH,QAAI,EAAEc,gBAAxC;AAA0D4I,SAAK,MAA/D;AAAgEC,wBAAoB,EAAE,KAAtF;AAA6FC,WAAO,EAAEE,iBAAtG;AAAyHhD,aAAS,EAAC;AAAnI,kBACID;AAAKC,aAAS,EAAEnF,MAAM,CAACoI;AAAvB,kBACIlD,oBAACmD,KAAD;AAAO7C,WAAO,EAAE,mBAAI;AAACpG,yBAAmB,CAAC,KAAD,CAAnBA;AAArB;AAAkD+F,aAAS,EAAC,SAA5D;AAAsEM,OAAG,EAAE,oCAA3E;AAAiHG,OAAG,EAAC,QAArH;AAA8HD,UAAM,EAAC,IAArI;AAA0ID,SAAK,EAAC;AAAhJ,IADJ,CADJ,eAIIR,oBAACoD,uBAAD;AAAyBC,oBAAgB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,MAAErB,YAAE;AAAA,aAAIqB,gBAAgB,CAACrB,EAAD,CAApB;AAAA,KAAJ,CAAzC;AAAuE1I,iBAAa,EAAE0I,yBAAE;AAAA,aAAI1I,cAAa,CAAC0I,EAAD,CAAjB;AAAA;AAAxF,IAJJ,CAhFF,CADN;AAvPG","names":["SearchbarComponent","props","useState","open","setOpen","pageLoaded","setPageLoaded","searchKeyword","setSearchKeyword","suggestions","setSuggestions","history","setHistory","inputFocus","setInputFocus","openMobileCam","setopenMobileCam","openDesktopPopup","setOpenDesktopPopup","imgUploaded","setimgUploaded","focusSearchbar","setFocusSearchbar","typeDelay","MathjaxConfig","tex2jax","inlineMath","displayMath","processEscapes","ignoreClass","styles","color","linebreaks","automatic","SVG","origin","API_ENDPOINT","AUTH_KEY","userToken","useEffect","console","log","document","fullscreenElement","exitFullscreen","er","timeoutId","setTimeout","get_suggestions","then","r","json","res","tempArray","i","length","push","setCookies","maxAge","sameSite","secure","err","clearTimeout","text","userId","formData","FormData","append","fetch","method","headers","body","searchInput","value","customSearch","clearSearch","window","replaceAll","replace","encodeURI","encode","enterButtonPressed","event","key","cameraClick","o","getElementById","openHistory","ques","href","removeOptions","input","output","replaceS3","isLive","re","RegExp","String","fromCharCode","characters","split","urls","j","found","url","toReplace","goodString","openQuestion","closeModal","showHistory","limit","getSearchHistory","React","className","byjus_search_widget_searchBarHolder","byjus_search_widget_searchBar","byjus_search_widget_searchbuttonHolder","byjus_search_widget_buttonHolder","onClick","src","width","height","alt","id","name","type","placeholder","onFocus","onKeyPress","e","onKeyUp","target","autoComplete","byjus_search_widget_buttonContainer","byjus_search_widget_crossButtonHolder","byjus_search_widget_icon","showindesktop","byjus_search_widget_showinmobile","byjus_search_widget_cameraButtonHolder1","byjus_search_widget_showindesktop","byjus_search_widget_cameraButtonHolder2","imgSearch","byjus_search_widget_suggestionHolder","map","el","byjus_search_widget_suggestionBox","MathJaxContext","config","MathJax","hideImage","dangerouslySetInnerHTML","__html","question_text","byjus_search_widget_historyBox","byjus_search_widget_clockIcon","searchText","Popup","modal","closeOnDocumentClick","onClose","ImageSearchPopup","closeDesktopModal","askADoubtPopupTopbannerCrossIcon","Image","ImageSearchDesktopPopup","setImageUploaded"],"sources":["../src/index.js"],"sourcesContent":["import React, { useEffect, useState} from \"react\";\nimport { MathJax, MathJaxContext } from \"better-react-mathjax\";\nimport { encode } from 'url-encode-decode';\nimport styles from './styles.module.css'\nimport Popup from \"reactjs-popup\";\n\nexport const SearchbarComponent = (props) => {\n  var [open, setOpen] = useState(false);\n  var [ pageLoaded, setPageLoaded] = useState(true); \n  var [searchKeyword, setSearchKeyword] = useState(null);\n  var [suggestions, setSuggestions] = useState([]);\n  var [history, setHistory] = useState([]);\n  var [inputFocus, setInputFocus] = useState(false);\n  var [openMobileCam, setopenMobileCam] = useState(false);\n  var [openDesktopPopup, setOpenDesktopPopup] = useState(false);\n  var [imgUploaded, setimgUploaded] = useState(false);\n  var [focusSearchbar, setFocusSearchbar] = useState(false);\n  const typeDelay = 500;\n  const MathjaxConfig = {tex2jax: { inlineMath: [ [\"\\\\$\", \"\\\\$\"], [\"\\\\(\", \"\\\\)\"] ], displayMath: [ [\"$$\",\"$$\"], [\"\\\\[\", \"\\\\]\"] ], processEscapes: true, ignoreClass: \"tex2jax_ignore|dno\" },\"HTML-CSS\": {styles: { \".MathJax .mo, .MathJax .mi\": {color: \"black ! important\"}, '.MathJax .merror': {'display': 'none'}}, linebreaks: { automatic:true }}, SVG: { linebreaks: { automatic: true } }}\n\n  const origin = 'learnportal2'\n  const API_ENDPOINT = 'https://search-api-stg.byjusweb.com/byjus/web_search/'\n  const AUTH_KEY = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJfaWQiOiI2MDVhMzc5MTg2M2YzYTViZTE0YjE0NzgiLCJyb2xlIjoiYnlqdS1hbnN3ZXItcmV2aWV3ZXIiLCJ0aW1lc3RhbXAiOiIyMDIxLTA1LTEwVDEwOjM0OjM4LjUyNloiLCJpYXQiOjE2MjA2NDI4Nzh9.f5xoVcgtvWAOwOnbc-VCMDjRwt7P4Pax5ftUL2TRUJQ';\n  const userToken = '2676038';\n\n  useEffect(()=>{\n    console.log('Hello')\n  },[]);\n\n  useEffect(()=>{\n    if(open==false && document.fullscreenElement!=null){\n        try{\n            document.exitFullscreen();\n        }\n        catch(er){}\n    }\n    }, [open])\n\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n        if(searchKeyword){\n            get_suggestions(searchKeyword, userToken).then(r=>r.json()).then(res=>{\n                var tempArray = [];\n\n                for(var i=0;i<res['suggestions'].length;i++){\n                    tempArray.push(\n                        {\n                            'question_text' : res['suggestions'][i]['mathjax_question'],\n                            'question_id' : res['suggestions'][i]['qid'],\n                            'href' : res['suggestions'][i]['href']\n                        }\n                    )\n                }\n                try{\n                    setCookies('docId', res['docId'], {maxAge: 60 * 60 * 24, sameSite: \"none\", secure: true});\n                }\n                catch(err){}\n                setSuggestions(tempArray);\n            })\n        }\n        }, typeDelay);\n    \n    return () => clearTimeout(timeoutId);\n    }, [searchKeyword]);\n\n    function get_suggestions(text, userId) {\n        const formData = new FormData();\n        formData.append(\"text\", text);\n        formData.append(\"origin\", origin)\n        return fetch(API_ENDPOINT + 'get_suggestions/', {\n            method: 'POST',\n            headers: {\n                'Authorization' : AUTH_KEY,\n                'X-Tnl-User-Id' : userId\n            },\n            body: formData,\n        })\n\n    }\n\n    function searchInput(value){\n        setSearchKeyword(value);\n        setSuggestions([]);\n    }\n\n    function customSearch(text){\n        clearSearch();\n        if(text){\n            setPageLoaded(false);\n            window.setTimeout(()=>{setPageLoaded(true)},3000);\n            text = text.replaceAll('+', '-plus-')\n            text = text.replaceAll('%', '-pcnt-');\n            text = text.replace( /(<([^>]+)>)/ig, '');\n            console.log( '/search/' + encodeURI(encode(text)))\n        }\n    }\n\n    function enterButtonPressed(event){\n        if(event.key === 'Enter'){\n            customSearch(searchKeyword);\n          }\n    }\n\n    function imageSearch() {\n        setOpenDesktopPopup(o => !o);\n    }\n\n    function cameraClick(){\n        setOpen(o => !o);\n        setopenMobileCam(true);\n        // openFullscreen();\n    }\n\n    function clearSearch(){\n        setInputFocus(false);\n        setSuggestions([]);\n        setSearchKeyword(null);\n        setHistory([]);\n        document.getElementById('searchInput').value = null;\n    }\n\n    function openHistory(ques){\n        if(ques.href){\n            console.log('/' + ques['href'] + '/')\n        }\n        else{\n            console.log('/search/' + encodeURI(encode(ques['searchText'])) + '/')\n        }\n    }\n\n    function removeOptions(input) {\n        if (input) {\n          try {\n            var output = input.replace(/\\s*<ul[^>]*>[\\S\\s]*?<\\/ul>\\s*/, \"\");\n            output = output.replace(/\\s*<ol[^>]*>[\\S\\s]*?<\\/ol>\\s*/, \"\");\n            output = replaceS3(output);\n          } catch (err) {\n            return output;\n          }\n          return output;\n        }\n      \n        return input;\n      }\n      \n    function replaceS3(input) {\n        if (input) {\n          try {\n            var output = \"\";\n            if (isLive) {\n              output = input.replace(\n                /https:\\/\\/meritnation-question-images.s3.ap-southeast-1.amazonaws.com/g,\n                \"https://search-static.byjusweb.com/question-images\"\n              );\n            } else {\n              output = input.replace(\n                /https:\\/\\/meritnation-question-images.s3.ap-southeast-1.amazonaws.com/g,\n                \"https://search-static-stg.byjusweb.com/question-images\"\n              );\n            }\n            output = output.replace(/<div>&#xA0;<\\/div>/g, \"\");\n            output = output.replace(/<p>&#xA0;<\\/p>/g, \"\");\n            output = output.replace(/<span>&#xA0;<\\/span>/g, \"\");\n            output = output.replace(/<div>&#xA0;<\\/div>/g, \"\");\n            output = output.replace(/<br\\/><br\\/>/g, \"<br/>\");\n            output = output.replace(/<br><br><br>/g, \"<br>\");\n            output = output.replace(/<br><br>/g, \"<br>\");\n            output = output.replace(/&nbsp;/g, \" \");\n            output = output.replace(/&#xA0;/g, \" \");\n            output = output.replace(/<em>/g, \"\");\n            var re = new RegExp(String.fromCharCode(160), \"g\");\n            output = output.replace(re, \" \");\n          } catch (err) {\n            return input;\n          }\n      \n          try {\n            var characters = output.split(\"\");\n            var urls = [];\n      \n            for (var i = 0; i < characters.length; i++) {\n              if (\n                characters[i] == \"s\" &&\n                characters[i + 1] == \"r\" &&\n                characters[i + 2] == \"c\" &&\n                characters[i + 3] == \"=\"\n              ) {\n                var j = i + 5;\n                var found = false;\n                var url = \"\";\n                while (!found) {\n                  if (characters[j] == '\"') {\n                    found = true;\n                    break;\n                  }\n                  url += characters[j];\n                  j++;\n                }\n                urls.push(url);\n              }\n            }\n            for (var i = 0; i < urls.length; i++) {\n              var toReplace = urls[i].split(\"https://\")[1];\n              var goodString = toReplace.replace(\"//\", \"/\");\n              output = output.replace(toReplace, goodString);\n            }\n          } catch (err) {\n            return output;\n          }\n      \n          return output;\n        }\n      \n        return input;\n      }\n\n    function openQuestion(ques, i){\n        console.log('/' + ques['href'] + '/');\n    }\n\n    function closeModal(){\n        setOpen(false);\n    }\n\n\n    function showHistory(limit){\n        getSearchHistory(limit).then(r=>r.json()).then(res=>{\n            setHistory(res['questions_asked']);\n         })\n    }\n\n    function getSearchHistory(limit){\n          return fetch(API_ENDPOINT + 'questions_by_user/' + userToken + '/' + limit + '/', {\n              method: 'GET',\n              headers: {\n                  'Content-Type': 'application/json',\n              },\n          })\n    }\n\n    function openFullscreen() {\n        var elem = document.body;\n        if (elem.requestFullscreen) {\n          elem.requestFullscreen();\n        } else if (elem.webkitRequestFullscreen) { /* Safari */\n          elem.webkitRequestFullscreen();\n        } else if (elem.msRequestFullscreen) { /* IE11 */\n          elem.msRequestFullscreen();\n        }\n      }\n\n\n    return(\n          <div className={styles.byjus_search_widget_searchBarHolder}>\n            <div className={styles.byjus_search_widget_searchBar}>\n                <div className={styles.byjus_search_widget_searchbuttonHolder}>\n                    <div className={styles.byjus_search_widget_buttonHolder}>\n                        <img  onClick={() => customSearch(searchKeyword)} src={\"https://search-static-stg.byjusweb.com/assets/SearchIcon1.png\"} width=\"24\" height=\"24\" alt=\"SearchIcon\"></img>\n                    </div>\n                </div>\n                <div>\n                    <input id=\"searchInput\" name=\"searchInput\" type=\"text\" placeholder={`Search for questions & chapters`}  onFocus={() => {setInputFocus(true);showHistory(5);}} onKeyPress={(e) => {enterButtonPressed(e)}} onKeyUp={(e)=>searchInput(e.target.value)} autoComplete=\"off\"></input>\n                </div>\n                <div className={styles.byjus_search_widget_buttonContainer}>\n                    <div className={styles.byjus_search_widget_buttonHolder}>\n                        { (inputFocus || suggestions.length>0 || history.length>0) && <div className={styles.byjus_search_widget_crossButtonHolder}>\n                            <img className={styles.byjus_search_widget_icon} onClick={() => clearSearch()} src={\"https://search-static-stg.byjusweb.com/assets/cancel.webp\"} width=\"12\" height=\"12\" alt=\"CrossIcon\"></img>\n                        </div>\n                        }\n                    </div>\n\n                    <div className={ inputFocus == true ? (styles.byjus_search_widget_buttonHolder + ' ' + styles.showindesktop) : (styles.byjus_search_widget_buttonHolder)}>\n                        <div className={styles.byjus_search_widget_showinmobile}>\n                            <div className={styles.byjus_search_widget_cameraButtonHolder1}>\n                                <img className={styles.byjus_search_widget_icon} onClick={() => cameraClick()} src={\"https://search-static-stg.byjusweb.com/assets/Camera.png\"} width=\"24\" height=\"24\" alt=\"CameraIcon\"></img>\n                            </div>\n                        </div>\n                        <div className={styles.byjus_search_widget_showindesktop}>\n                            <div className={styles.byjus_search_widget_cameraButtonHolder2}>\n                                <img className={styles.byjus_search_widget_icon} onClick={() => imgSearch()} src={\"https://search-static-stg.byjusweb.com/assets/Camera.png\"} width=\"24\" height=\"24\" alt=\"CameraIcon\"></img>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \n                {suggestions.length>0 &&\n                    <div className={styles.byjus_search_widget_suggestionHolder}>\n                        {suggestions.map((el,i) =>\n                        <div key={'suggestion_' + i}>\n                        {el.href &&\n                        <div className={styles.byjus_search_widget_suggestionBox} onClick={() => {openQuestion(el, i);}}>\n                            <div>\n                            <MathJaxContext config={MathjaxConfig}>\n                                <MathJax>\n                                    <div className={styles.hideImage} dangerouslySetInnerHTML={{ __html: removeOptions(el.question_text) || ''}}></div>\n                                </MathJax>\n                            </MathJaxContext>\n                            </div>\n                            <div>\n                                <img src={\"https://search-static-stg.byjusweb.com/assets/SearchRecommendation.png\"} width=\"24\" height=\"24\" alt=\"search-recommendation\"></img>\n                            </div>\n                        </div>\n                        }\n                        </div>\n                        )}\n                    </div>\n                }\n                {suggestions.length == 0 && history.length > 0 && !searchKeyword &&\n                    <div className={styles.byjus_search_widget_suggestionHolder}>\n                        {history.map((el,i) =>\n                        <div className={styles.byjus_search_widget_historyBox} onClick={() => {openHistory(el);}}>\n                            <div className={styles.byjus_search_widget_clockIcon}>\n                                <img src={\"https://search-static-stg.byjusweb.com/assets/SearchHistory.png\"} width=\"20\" height=\"20\" alt=\"search-history\"></img>\n                            </div>\n                            <div>\n                                <MathJaxContext config={MathjaxConfig}>\n                                    <MathJax>\n                                        <div className={styles.hideImage} dangerouslySetInnerHTML={{ __html: removeOptions(el.searchText) || ''}}></div>\n                                    </MathJax>\n                                </MathJaxContext>\n                            </div>\n                            <div>\n                                <img src={\"https://search-static-stg.byjusweb.com/assets/SearchRecommendation.png\"} width=\"24\" height=\"24\" alt=\"search-recommendation\"></img>\n                            </div>\n                        </div>\n                        )}\n                    </div>\n                }\n            </div>\n\n            <Popup id=\"popup_camera\" open={open} modal closeOnDocumentClick={false} onClose={closeModal} className=\"uploadPopup\">\n                <ImageSearchPopup openMobileCam = {openMobileCam} setFocusSearchbar = {el => setFocusSearchbar(el)} setOpen={el => setOpen(el)} setPageLoaded={el => setPageLoaded(el)}></ImageSearchPopup>\n            </Popup>\n            <Popup  id=\"popup_camera_desktop\" open={openDesktopPopup} modal closeOnDocumentClick={false} onClose={closeDesktopModal} className=\"askADoubt-popup\">\n                <div className={styles.askADoubtPopupTopbannerCrossIcon}>\n                    <Image onClick={()=>{setOpenDesktopPopup(false)}} className=\"pointer\" src={\"/question-answer/crossGreyIcon.png\"} alt=\"loader\" height=\"40\" width=\"40\"></Image>\n                </div>\n                <ImageSearchDesktopPopup setImageUploaded={el => setImageUploaded(el)} setPageLoaded={el => setPageLoaded(el)}></ImageSearchDesktopPopup>\n            </Popup>\n        </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}